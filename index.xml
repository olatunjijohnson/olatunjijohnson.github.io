<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dr Olatunji Johnson</title>
    <link>/</link>
      <atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    <description>Dr Olatunji Johnson</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language>
    <image>
      <url>/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>Dr Olatunji Johnson</title>
      <link>/</link>
    </image>
    
    <item>
      <title>Example Page 1</title>
      <link>/courses/example/example1/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>/courses/example/example1/</guid>
      <description>&lt;p&gt;In this tutorial, I&amp;rsquo;ll share my top 10 tips for getting started with Academic:&lt;/p&gt;
&lt;h2 id=&#34;tip-1&#34;&gt;Tip 1&lt;/h2&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;
&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;
&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;
&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;
&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
&lt;h2 id=&#34;tip-2&#34;&gt;Tip 2&lt;/h2&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;
&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;
&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;
&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;
&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Example Page 2</title>
      <link>/courses/example/example2/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>/courses/example/example2/</guid>
      <description>&lt;p&gt;Here are some more tips for getting started with Academic:&lt;/p&gt;
&lt;h2 id=&#34;tip-3&#34;&gt;Tip 3&lt;/h2&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;
&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;
&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;
&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;
&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
&lt;h2 id=&#34;tip-4&#34;&gt;Tip 4&lt;/h2&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;
&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;
&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;
&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;
&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Model-based geostatistical methods enable efficient design and analysis of prevalence surveys for soil-transmitted helminth infection and other neglected tropical diseases</title>
      <link>/publication/sth_design/</link>
      <pubDate>Mon, 14 Jun 2021 00:00:00 +0100</pubDate>
      <guid>/publication/sth_design/</guid>
      <description></description>
    </item>
    
    <item>
      <title>A modelling framework for developing early warning systems of COPD emergency admissions</title>
      <link>/publication/copd/</link>
      <pubDate>Mon, 01 Feb 2021 00:00:00 +0000</pubDate>
      <guid>/publication/copd/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Elimination of STH morbidity in Zimbabwe: Results of 6 years of deworming intervention for school-age children</title>
      <link>/publication/sth_zimbabwe/</link>
      <pubDate>Fri, 23 Oct 2020 00:00:00 +0100</pubDate>
      <guid>/publication/sth_zimbabwe/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Multiple Y Axes Plot with Plotly</title>
      <link>/post/plotly/plotly/</link>
      <pubDate>Fri, 01 May 2020 00:00:00 +0000</pubDate>
      <guid>/post/plotly/plotly/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-binding/plotly.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/typedarray/typedarray.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/crosstalk/css/crosstalk.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/crosstalk/js/crosstalk.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-main/plotly-latest.min.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;This post briefly describe how to produce a multiple axes plot in R using plotly. Happy reading!!!&lt;/p&gt;
&lt;p&gt;Generate the Data&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;countM &amp;lt;-rpois(n = 26, lambda = 10)
countF &amp;lt;-rpois(n = 26, lambda = 10)
rateM &amp;lt;- countM/1000
rateF &amp;lt;- countF/1000
age &amp;lt;- LETTERS[seq( from = 1, to = 26 )]
data &amp;lt;- data.frame(countM, countF, rateM, rateF, age)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Load the packages&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;require(tidyverse)
require(ggplot2)
require(plotly)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create the Multiple Y Axes&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#create
ay &amp;lt;- list(
  tickfont = list(color = &amp;quot;red&amp;quot;),
  overlaying = &amp;quot;y&amp;quot;,
  side = &amp;quot;right&amp;quot;,
  title = &amp;quot;Rate&amp;quot;
)

l &amp;lt;- list(
  font = list(
    family = &amp;quot;sans-serif&amp;quot;,
    size = 12,
    color = &amp;quot;#000&amp;quot;),
  bgcolor = &amp;quot;#E2E2E2&amp;quot;,
  bordercolor = &amp;quot;#FFFFFF&amp;quot;,
  borderwidth = 2,
  orientation= &amp;quot;h&amp;quot;, x = 1.05, y = 1)


p &amp;lt;- plot_ly(data, x = ~age, y = ~countM, type = &amp;#39;bar&amp;#39;, name = &amp;#39;Male&amp;#39;) %&amp;gt;%
  add_trace(y = ~countF, name = &amp;#39;female&amp;#39;) %&amp;gt;%
  add_lines(x=~age, y=~rateM, name = &amp;quot;rate of Male&amp;quot;, yaxis = &amp;quot;y2&amp;quot;) %&amp;gt;%
  add_lines(x=~age, y=~rateF, name = &amp;quot;rate of Female&amp;quot;, yaxis = &amp;quot;y2&amp;quot;) %&amp;gt;%
  layout(title = &amp;#39;Age and Sex distribution&amp;#39;, 
         yaxis = list(title = &amp;#39;count&amp;#39;), 
         xaxis= list(title=&amp;quot;Age&amp;quot;), 
         yaxis2 = ay, 
         barmode = &amp;#39;group&amp;#39;,
         bargap = 0.15, legend= l)

p&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;plotly html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;visdat&#34;:{&#34;5f7b73f31073&#34;:[&#34;function () &#34;,&#34;plotlyVisDat&#34;]},&#34;cur_data&#34;:&#34;5f7b73f31073&#34;,&#34;attrs&#34;:{&#34;5f7b73f31073&#34;:{&#34;x&#34;:{},&#34;y&#34;:{},&#34;name&#34;:&#34;Male&#34;,&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;bar&#34;},&#34;5f7b73f31073.1&#34;:{&#34;x&#34;:{},&#34;y&#34;:{},&#34;name&#34;:&#34;female&#34;,&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;bar&#34;,&#34;inherit&#34;:true},&#34;5f7b73f31073.2&#34;:{&#34;x&#34;:{},&#34;y&#34;:{},&#34;name&#34;:&#34;rate of Male&#34;,&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;scatter&#34;,&#34;mode&#34;:&#34;lines&#34;,&#34;yaxis&#34;:&#34;y2&#34;,&#34;inherit&#34;:true},&#34;5f7b73f31073.3&#34;:{&#34;x&#34;:{},&#34;y&#34;:{},&#34;name&#34;:&#34;rate of Female&#34;,&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;scatter&#34;,&#34;mode&#34;:&#34;lines&#34;,&#34;yaxis&#34;:&#34;y2&#34;,&#34;inherit&#34;:true}},&#34;layout&#34;:{&#34;margin&#34;:{&#34;b&#34;:40,&#34;l&#34;:60,&#34;t&#34;:25,&#34;r&#34;:10},&#34;title&#34;:&#34;Age and Sex distribution&#34;,&#34;yaxis&#34;:{&#34;domain&#34;:[0,1],&#34;automargin&#34;:true,&#34;title&#34;:&#34;count&#34;},&#34;xaxis&#34;:{&#34;domain&#34;:[0,1],&#34;automargin&#34;:true,&#34;title&#34;:&#34;Age&#34;,&#34;type&#34;:&#34;category&#34;,&#34;categoryorder&#34;:&#34;array&#34;,&#34;categoryarray&#34;:[&#34;A&#34;,&#34;B&#34;,&#34;C&#34;,&#34;D&#34;,&#34;E&#34;,&#34;F&#34;,&#34;G&#34;,&#34;H&#34;,&#34;I&#34;,&#34;J&#34;,&#34;K&#34;,&#34;L&#34;,&#34;M&#34;,&#34;N&#34;,&#34;O&#34;,&#34;P&#34;,&#34;Q&#34;,&#34;R&#34;,&#34;S&#34;,&#34;T&#34;,&#34;U&#34;,&#34;V&#34;,&#34;W&#34;,&#34;X&#34;,&#34;Y&#34;,&#34;Z&#34;]},&#34;yaxis2&#34;:{&#34;tickfont&#34;:{&#34;color&#34;:&#34;red&#34;},&#34;overlaying&#34;:&#34;y&#34;,&#34;side&#34;:&#34;right&#34;,&#34;title&#34;:&#34;Rate&#34;},&#34;barmode&#34;:&#34;group&#34;,&#34;bargap&#34;:0.15,&#34;legend&#34;:{&#34;font&#34;:{&#34;family&#34;:&#34;sans-serif&#34;,&#34;size&#34;:12,&#34;color&#34;:&#34;#000&#34;},&#34;bgcolor&#34;:&#34;#E2E2E2&#34;,&#34;bordercolor&#34;:&#34;#FFFFFF&#34;,&#34;borderwidth&#34;:2,&#34;orientation&#34;:&#34;h&#34;,&#34;x&#34;:1.05,&#34;y&#34;:1},&#34;hovermode&#34;:&#34;closest&#34;,&#34;showlegend&#34;:true},&#34;source&#34;:&#34;A&#34;,&#34;config&#34;:{&#34;showSendToCloud&#34;:false},&#34;data&#34;:[{&#34;x&#34;:[&#34;A&#34;,&#34;B&#34;,&#34;C&#34;,&#34;D&#34;,&#34;E&#34;,&#34;F&#34;,&#34;G&#34;,&#34;H&#34;,&#34;I&#34;,&#34;J&#34;,&#34;K&#34;,&#34;L&#34;,&#34;M&#34;,&#34;N&#34;,&#34;O&#34;,&#34;P&#34;,&#34;Q&#34;,&#34;R&#34;,&#34;S&#34;,&#34;T&#34;,&#34;U&#34;,&#34;V&#34;,&#34;W&#34;,&#34;X&#34;,&#34;Y&#34;,&#34;Z&#34;],&#34;y&#34;:[9,10,11,12,8,12,8,8,7,8,7,10,12,10,14,11,8,14,10,14,7,11,9,12,14,6],&#34;name&#34;:&#34;Male&#34;,&#34;type&#34;:&#34;bar&#34;,&#34;marker&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;,&#34;line&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;}},&#34;error_y&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;},&#34;error_x&#34;:{&#34;color&#34;:&#34;rgba(31,119,180,1)&#34;},&#34;xaxis&#34;:&#34;x&#34;,&#34;yaxis&#34;:&#34;y&#34;,&#34;frame&#34;:null},{&#34;x&#34;:[&#34;A&#34;,&#34;B&#34;,&#34;C&#34;,&#34;D&#34;,&#34;E&#34;,&#34;F&#34;,&#34;G&#34;,&#34;H&#34;,&#34;I&#34;,&#34;J&#34;,&#34;K&#34;,&#34;L&#34;,&#34;M&#34;,&#34;N&#34;,&#34;O&#34;,&#34;P&#34;,&#34;Q&#34;,&#34;R&#34;,&#34;S&#34;,&#34;T&#34;,&#34;U&#34;,&#34;V&#34;,&#34;W&#34;,&#34;X&#34;,&#34;Y&#34;,&#34;Z&#34;],&#34;y&#34;:[7,8,11,13,7,7,9,9,14,10,12,7,9,5,9,11,11,7,11,15,18,10,10,6,12,8],&#34;name&#34;:&#34;female&#34;,&#34;type&#34;:&#34;bar&#34;,&#34;marker&#34;:{&#34;color&#34;:&#34;rgba(255,127,14,1)&#34;,&#34;line&#34;:{&#34;color&#34;:&#34;rgba(255,127,14,1)&#34;}},&#34;error_y&#34;:{&#34;color&#34;:&#34;rgba(255,127,14,1)&#34;},&#34;error_x&#34;:{&#34;color&#34;:&#34;rgba(255,127,14,1)&#34;},&#34;xaxis&#34;:&#34;x&#34;,&#34;yaxis&#34;:&#34;y&#34;,&#34;frame&#34;:null},{&#34;x&#34;:[&#34;A&#34;,&#34;B&#34;,&#34;C&#34;,&#34;D&#34;,&#34;E&#34;,&#34;F&#34;,&#34;G&#34;,&#34;H&#34;,&#34;I&#34;,&#34;J&#34;,&#34;K&#34;,&#34;L&#34;,&#34;M&#34;,&#34;N&#34;,&#34;O&#34;,&#34;P&#34;,&#34;Q&#34;,&#34;R&#34;,&#34;S&#34;,&#34;T&#34;,&#34;U&#34;,&#34;V&#34;,&#34;W&#34;,&#34;X&#34;,&#34;Y&#34;,&#34;Z&#34;],&#34;y&#34;:[0.009,0.01,0.011,0.012,0.008,0.012,0.008,0.008,0.007,0.008,0.007,0.01,0.012,0.01,0.014,0.011,0.008,0.014,0.01,0.014,0.007,0.011,0.009,0.012,0.014,0.006],&#34;name&#34;:&#34;rate of Male&#34;,&#34;type&#34;:&#34;scatter&#34;,&#34;mode&#34;:&#34;lines&#34;,&#34;yaxis&#34;:&#34;y2&#34;,&#34;marker&#34;:{&#34;color&#34;:&#34;rgba(44,160,44,1)&#34;,&#34;line&#34;:{&#34;color&#34;:&#34;rgba(44,160,44,1)&#34;}},&#34;error_y&#34;:{&#34;color&#34;:&#34;rgba(44,160,44,1)&#34;},&#34;error_x&#34;:{&#34;color&#34;:&#34;rgba(44,160,44,1)&#34;},&#34;line&#34;:{&#34;color&#34;:&#34;rgba(44,160,44,1)&#34;},&#34;xaxis&#34;:&#34;x&#34;,&#34;frame&#34;:null},{&#34;x&#34;:[&#34;A&#34;,&#34;B&#34;,&#34;C&#34;,&#34;D&#34;,&#34;E&#34;,&#34;F&#34;,&#34;G&#34;,&#34;H&#34;,&#34;I&#34;,&#34;J&#34;,&#34;K&#34;,&#34;L&#34;,&#34;M&#34;,&#34;N&#34;,&#34;O&#34;,&#34;P&#34;,&#34;Q&#34;,&#34;R&#34;,&#34;S&#34;,&#34;T&#34;,&#34;U&#34;,&#34;V&#34;,&#34;W&#34;,&#34;X&#34;,&#34;Y&#34;,&#34;Z&#34;],&#34;y&#34;:[0.007,0.008,0.011,0.013,0.007,0.007,0.009,0.009,0.014,0.01,0.012,0.007,0.009,0.005,0.009,0.011,0.011,0.007,0.011,0.015,0.018,0.01,0.01,0.006,0.012,0.008],&#34;name&#34;:&#34;rate of Female&#34;,&#34;type&#34;:&#34;scatter&#34;,&#34;mode&#34;:&#34;lines&#34;,&#34;yaxis&#34;:&#34;y2&#34;,&#34;marker&#34;:{&#34;color&#34;:&#34;rgba(214,39,40,1)&#34;,&#34;line&#34;:{&#34;color&#34;:&#34;rgba(214,39,40,1)&#34;}},&#34;error_y&#34;:{&#34;color&#34;:&#34;rgba(214,39,40,1)&#34;},&#34;error_x&#34;:{&#34;color&#34;:&#34;rgba(214,39,40,1)&#34;},&#34;line&#34;:{&#34;color&#34;:&#34;rgba(214,39,40,1)&#34;},&#34;xaxis&#34;:&#34;x&#34;,&#34;frame&#34;:null}],&#34;highlight&#34;:{&#34;on&#34;:&#34;plotly_click&#34;,&#34;persistent&#34;:false,&#34;dynamic&#34;:false,&#34;selectize&#34;:false,&#34;opacityDim&#34;:0.2,&#34;selected&#34;:{&#34;opacity&#34;:1},&#34;debounce&#34;:0},&#34;shinyEvents&#34;:[&#34;plotly_hover&#34;,&#34;plotly_click&#34;,&#34;plotly_selected&#34;,&#34;plotly_relayout&#34;,&#34;plotly_brushed&#34;,&#34;plotly_brushing&#34;,&#34;plotly_clickannotation&#34;,&#34;plotly_doubleclick&#34;,&#34;plotly_deselect&#34;,&#34;plotly_afterplot&#34;,&#34;plotly_sunburstclick&#34;],&#34;base_url&#34;:&#34;https://plot.ly&#34;},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;You can create a link to your chart&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Create a shareable link to your chart
# Set up API credentials: https://plot.ly/r/getting-started
# chart_link = api_create(p, filename=&amp;quot;multiple-y-axes&amp;quot;)
# chart_link&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Dealing with spatial misalignment to model the relationship between deprivation and life expectancy: a model-based geostatistical approach</title>
      <link>/publication/misalignment/</link>
      <pubDate>Sun, 01 Mar 2020 00:00:00 +0000</pubDate>
      <guid>/publication/misalignment/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Statistical Modelling Approaches to Disease Mapping</title>
      <link>/talk/capetown/</link>
      <pubDate>Wed, 29 Jan 2020 13:00:00 +0000</pubDate>
      <guid>/talk/capetown/</guid>
      <description></description>
    </item>
    
    <item>
      <title>A Spatially Discrete Approximation to Log-Gaussian Cox Processes for Modelling Aggregated Disease Count Data</title>
      <link>/publication/sdalgcp/</link>
      <pubDate>Mon, 01 Jul 2019 00:00:00 +0100</pubDate>
      <guid>/publication/sdalgcp/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Spatial Probit Model Using Gaussian Random Field</title>
      <link>/post/probit_model/probit_modelling_markdown/</link>
      <pubDate>Thu, 14 Mar 2019 00:00:00 +0000</pubDate>
      <guid>/post/probit_model/probit_modelling_markdown/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Spatial probit models is very popular in spatial econometrics and the book of &lt;span class=&#34;citation&#34;&gt;J. LeSage and Pace (2009)&lt;/span&gt; gives a very good overview. This is basically an extension of probit model when one is interested to adjust for both fixed and spatial random effect. &lt;span class=&#34;citation&#34;&gt;J. P. LeSage (2000)&lt;/span&gt; model the spatial random effect using the class of Gaussian Markov Random Field (GMRF) introduced by &lt;span class=&#34;citation&#34;&gt;Besag, York, and Mollié (1991)&lt;/span&gt; and provides a Bayesian procedure for fitting this class of model. &lt;span class=&#34;citation&#34;&gt;Smith and LeSage (2004)&lt;/span&gt; further extends the probit model to allow for spatial random effect and individual random effect.&lt;/p&gt;
&lt;p&gt;Most of the extension to allow for spatial dependence structure utilises Simultatenous Autoregressive model (SAR) and Conditional autoregressive model (CAR) - a class of Gaussian markov random field (GMRF). The use of Guassian Random Field (GFR) is not popular for probit model, infact we cannot find any in literature. It was pointed out in &lt;span class=&#34;citation&#34;&gt;Brooks et al. (2011)&lt;/span&gt; that estimating the covariance parameter of the GRF in a spatial probit model suffers from identifiability issues. And noted that a binary outcome contain less information about the magnitude of dependence. Also suggest using GMRF because “it aggregates pieces of binary information from the neigbouring regions to better estimate spatial depencies”. However, this is true because the the spatial dependence parameter is linear in the linear predictor and there exist a nice framework proposed by &lt;span class=&#34;citation&#34;&gt;Besag, York, and Mollié (1991)&lt;/span&gt; that allows for this. It is important to note that there are several debates on the interpretation of the spatial dependence paramter of a CAR or SAR model. By using GMRF models, an explicit assumption that is made is that the spatial dependence parameter reflects a situation where values observed at one region, say observation &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;, depend on the values of neighboring observations at nearby regions. And using a GRF, we basically assume that there is a spatial continuous process that generate any observation at any region.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;methodological-framework&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Methodological Framework&lt;/h1&gt;
&lt;p&gt;Let &lt;span class=&#34;math inline&#34;&gt;\(Y_{ijk}\)&lt;/span&gt; be the binary outcome for an admission &lt;span class=&#34;math inline&#34;&gt;\(i= 1, \ldots, L\)&lt;/span&gt; for patient &lt;span class=&#34;math inline&#34;&gt;\(k= 1, \ldots, N\)&lt;/span&gt; living in region &lt;span class=&#34;math inline&#34;&gt;\(j= 1, \ldots, M\)&lt;/span&gt;. A augumented probit model proposed by &lt;span class=&#34;citation&#34;&gt;Albert and Chib (1993)&lt;/span&gt; usually assume that the outcome is generated through an underlying latent variable, $Z_{ijk}, with the following hierarchical structure.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ Y_{ijk} = \begin{cases} 
      1 &amp;amp; Z_{ijk} &amp;gt; 0 \\
      0 &amp;amp; Z_{ijk} \leq 0
   \end{cases}
\]&lt;/span&gt;&lt;/p&gt;
&lt;ol class=&#34;example&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math display&#34;&gt;\[Z_{ijk} =  d_{ijk}^\top \beta + S_j + U_{k} + \epsilon_{ijk}\]&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;with the following prior distributions&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\epsilon_{ijk} \sim \mathcal{N}(0, 1)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\beta  \sim \mathcal{N}(\mu_\beta, \Sigma_\beta)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[S \sim  \mathcal{N}(0, \Sigma(\theta))\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[Z \sim \mathcal{N}(0, \tau^2I) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&#34;math inline&#34;&gt;\(d_{ijk}\)&lt;/span&gt; is the vector of &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; covariates with associated coefficient &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(S_j\)&lt;/span&gt; is the region specific random effect and it is define using GRF and &lt;span class=&#34;math inline&#34;&gt;\(U_{k}\)&lt;/span&gt; is an patient or individual random effect, &lt;span class=&#34;math inline&#34;&gt;\(\epsilon_{ijk}\)&lt;/span&gt; is the error term.&lt;/p&gt;
&lt;ol start=&#34;2&#34; class=&#34;example&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;can be re-written in vector form as&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[Z =  D^\top \beta + \Delta_1S +  \Delta_2 U + \epsilon\]&lt;/span&gt; where &lt;span class=&#34;math inline&#34;&gt;\(Z=(Z_{ijk}: i = 1, \ldots, L, j= 1, \ldots, M, k = 1, \ldots, N)&amp;#39;\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(S=(S_{j}: j= 1, \ldots, M)&amp;#39;\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(U=(U_{j}: j= 1, \ldots, U)&amp;#39;\)&lt;/span&gt;, &lt;span class=&#34;math display&#34;&gt;\[ \Delta_1 = 
\begin{pmatrix}
1 &amp;amp; &amp;amp; \\
 &amp;amp;\ddots &amp;amp;\\
 &amp;amp;  &amp;amp; 1
\end{pmatrix}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The joint posterior distribution of &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\theta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\tau^2\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt; is given by,&lt;/p&gt;
&lt;p&gt;2 &lt;span class=&#34;math display&#34;&gt;\[ \label{eq:post} 
 p(\beta, \theta, \tau^2, S, U, Z | Y) = \pi(\beta) \pi(\theta) \pi(\tau^2) f(S| \theta) f(U | \tau^2) f(Z | S, U, \beta, \theta, \tau^2) f(Y|Z) 
 \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We use MCMC algorithm to update these parameters in turn&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Initialise &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\theta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\tau^2\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Update joint posterior of &lt;span class=&#34;math inline&#34;&gt;\(\theta\)&lt;/span&gt; using random-walk Metropolis Hastings (RWMH)&lt;/li&gt;
&lt;li&gt;Update joint posterior of &lt;span class=&#34;math inline&#34;&gt;\(\tau\)&lt;/span&gt; using random-walk Metropolis Hastings (RWMH)&lt;/li&gt;
&lt;li&gt;Update joint posterior of &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; using a Gibbs step. The posterior distribution for &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; is Gaussian since we assign a conjugate prior on &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, hence &lt;span class=&#34;math display&#34;&gt;\[ [\beta| \cdot] = \mathcal{N}(M_\beta, V_\beta),\]&lt;/span&gt; where &lt;span class=&#34;math display&#34;&gt;\[V_\beta = (D^\top D + \Sigma_\beta^{-1})^{-1} \]&lt;/span&gt; and &lt;span class=&#34;math display&#34;&gt;\[M_\beta = V_\beta (D^\top (Z- (S+U)) + \Sigma_\beta^{-1} \mu_\beta) \]&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Update joint posterior of &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; using a Gibbs step. The posterior distribution for &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; is Gaussian since we assign a conjugate prior on &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;, hence &lt;span class=&#34;math display&#34;&gt;\[ [S| \cdot] \sim \mathcal{N}(M_S, V_S),\]&lt;/span&gt; where &lt;span class=&#34;math display&#34;&gt;\[V_S = (\Delta_1^\top \Delta_1 + \Sigma_S^{-1})^{-1} \]&lt;/span&gt; and &lt;span class=&#34;math display&#34;&gt;\[M_S = V_S (\Delta_1^\top (Z- (D\beta+ \Delta_2U))) \]&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Update joint posterior of &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt; using a Gibbs step. The posterior distribution for &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt; is Gaussian since we assign a conjugate prior on &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt;, hence &lt;span class=&#34;math display&#34;&gt;\[ [U| \cdot] \sim \mathcal{N}(M_U, V_U),\]&lt;/span&gt; where &lt;span class=&#34;math display&#34;&gt;\[V_U = (\Delta_2^\top \Delta_2 + \Sigma_S^{-1})^{-1} \]&lt;/span&gt; and &lt;span class=&#34;math display&#34;&gt;\[M_U = V_U (\Delta_2^\top (Z- (D\beta+ \Delta_1 S))) \]&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Update joint posterior of &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt; using a Gibbs step. The posterior distribution for &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt; is truncated Gaussian, hence &lt;span class=&#34;math display&#34;&gt;\[ [Z| \cdot] \sim  \mathcal{TN}(D\beta+ \Delta_1 S + \Delta_2 U, 1, I(Y, Z)),\]&lt;/span&gt; where &lt;span class=&#34;math display&#34;&gt;\[I(Y, Z) = I(Y=1)I(Z &amp;gt; 0) + I(Y=0)I(Z \leq 0)\]&lt;/span&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;simulation-study&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Simulation Study&lt;/h1&gt;
&lt;div id=&#34;generating-synthetic-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Generating synthetic data&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#load the required package
library(geoR, quietly = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## --------------------------------------------------------------
##  Analysis of Geostatistical Data
##  For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
##  geoR version 1.7-5.2.1 (built on 2016-05-02) is now loaded
## --------------------------------------------------------------&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;require(Matrix, quietly = TRUE)
#simulating my type of data
n_add &amp;lt;- 250
n_pat &amp;lt;- 150
n_reg &amp;lt;- 50
adm &amp;lt;- 1:n_add
pat &amp;lt;- c(1:n_pat, sample(1:n_pat, n_add-n_pat))
reg &amp;lt;- c(1:n_reg, sample(1:n_reg, n_add-n_reg, replace=TRUE))
data &amp;lt;- data.frame(adm, pat, reg)
#####
x &amp;lt;- rnorm(n_add)
# Create n x D design matrix
D &amp;lt;- 2
# We learn a linear function
X &amp;lt;- cbind(rep(1, n_add), x)
# True values of regression coeffiecients theta
true_theta &amp;lt;- c(-0.5, 0.5)
# simulate the gaussian process
S &amp;lt;- grf(n=n_reg, grid = &amp;quot;irreg&amp;quot;, cov.pars = c(1, 0.5), xlims = c(0, 6), ylims = c(0, 6))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## grf: simulation(s) on randomly chosen locations with  50  points
## grf: process with  1  covariance structure(s)
## grf: nugget effect is: tausq= 0 
## grf: covariance model 1 is: exponential(sigmasq=1, phi=0.5)
## grf: decomposition algorithm used is:  cholesky 
## grf: End of simulation procedure. Number of realizations: 1&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;xy &amp;lt;- S$coords
u &amp;lt;- rnorm(n_pat, sd=sqrt(0.2))
# create the mapping matrix
inc_mat_reg &amp;lt;-t(as(as.factor(reg),Class=&amp;quot;sparseMatrix&amp;quot;))
inc_mat_pat &amp;lt;-t(as(as.factor(pat),Class=&amp;quot;sparseMatrix&amp;quot;))
# Obtain the vector with probabilities of success p using the probit link
p &amp;lt;- pnorm(as.numeric(X %*% true_theta + inc_mat_reg%*%cbind(S$data) + inc_mat_pat%*%cbind(u)))
# Generate binary observation data y
y &amp;lt;- cbind(rbinom(n_add, 1, p))
data &amp;lt;- data.frame(data, x, y)
head(data)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   adm pat reg          x y
## 1   1   1   1  0.5402883 0
## 2   2   2   2  0.1756355 0
## 3   3   3   3  1.1559319 1
## 4   4   4   4  0.8420048 0
## 5   5   5   5 -0.4327365 0
## 6   6   6   6 -0.9763709 0&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;fiting-a-non-spatial-model&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Fiting a non spatial model&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# fit the non-spatial model
fit &amp;lt;- glm(formula = y~x, family = binomial(link = &amp;quot;probit&amp;quot;), data=data)
summary(fit)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## glm(formula = y ~ x, family = binomial(link = &amp;quot;probit&amp;quot;), data = data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3398  -0.8973  -0.7382   1.3171   2.0473  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&amp;gt;|z|)    
## (Intercept) -0.46790    0.08364  -5.594 2.22e-08 ***
## x            0.25979    0.08494   3.058  0.00222 ** 
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 313.43  on 249  degrees of freedom
## Residual deviance: 303.73  on 248  degrees of freedom
## AIC: 307.73
## 
## Number of Fisher Scoring iterations: 4&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;fiting-a-full-bayesian-spatial-probit-model-using-grf&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Fiting a full bayesian spatial probit model using GRF&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Library for sampling from Multivariate Normal distribution
require(mvtnorm, quietly = TRUE)
# Library for sampling from Truncated Normal distribution
require(truncnorm, quietly = TRUE)
# Variables that we will need later
N1  &amp;lt;- sum(y)  # Number of successes
N0  &amp;lt;- n_add - N1  # Number of failures

# Conjugate prior on the coefficients \beta ~ N(mu_beta, Sigma_beta)
mu_beta &amp;lt;- c(fit$coefficients)
# Sigma_beta &amp;lt;- diag(10, 2)
Sigma_beta &amp;lt;- as.matrix(vcov(fit)) * 10

# Compute the distance matrix over the region
U &amp;lt;- as.matrix(dist(xy))

# proposal covariance
prop_Sigma &amp;lt;- matrix(c(0.01, 0, 0, 0.01), 2)
prop_Sigma_tau2 &amp;lt;- 0.01

# [,1]       [,2]
# [1,] 0.14450882 0.03176559
# [2,] 0.03176559 0.34874799

# Initialize parameters
re_para &amp;lt;- c(1, 0.5, 0.2)
beta &amp;lt;- c(-0.5, 0.5)
Sigma_s &amp;lt;-re_para[1]*exp(-U/re_para[2])
S &amp;lt;- rmvnorm(n = 1, mean = rep(0, n_reg), sigma = Sigma_s)
u &amp;lt;- rnorm(n = n_pat, mean = 0, sd=sqrt(re_para[3]))
mu_z &amp;lt;- X %*% beta + inc_mat_reg%*%as.numeric(S) + inc_mat_pat%*%u
z &amp;lt;- rep(0, n_add)
z[y == 0] &amp;lt;- rtruncnorm(N0, mean = mu_z[y == 0], sd = 1, a = -Inf, b = 0)
z[y == 1] &amp;lt;- rtruncnorm(N1, mean = mu_z[y == 1], sd = 1, a = 0, b = Inf)


# Number of simulations for Gibbs sampler
N_sim &amp;lt;- 110000
# Burn in period
burn_in &amp;lt;- 10000
# Matrix storing samples of the \beta parameter
beta_chain &amp;lt;- matrix(beta, nrow = N_sim, ncol = D)
# Matrix storing samples of the latent variable, z
z_chain &amp;lt;- matrix(0, nrow = N_sim, ncol = n_add)
# Matrix storing samples of the parameter of S and U, sigma^2, phi and tau^2
re_para_chain &amp;lt;- matrix(re_para, nrow = N_sim, ncol = 3)



# ---------------------------------
# Gibbs sampling algorithm
# ---------------------------------
# Compute posterior variance of beta
prec_beta &amp;lt;- solve(Sigma_beta)
V &amp;lt;- solve(prec_beta + crossprod(X, X))
#acceptance probability
accept1 &amp;lt;- 0
accept2 &amp;lt;- 0
for (t in 2:N_sim) {
  
  #  get the random effect parameters
  sigma2 &amp;lt;- re_para[1]
  phi &amp;lt;- re_para[2]
  tau2 &amp;lt;- re_para[3]
  
  # update the proposal variance
  if (t &amp;gt; 1000){
    prop_Sigma &amp;lt;- cov(log(re_para_chain[,1:2]))*((2.38)^2)/2
    prop_Sigma_tau2 &amp;lt;- cov(log(re_para_chain))[3,3]*((2.38)^2)
  }
  
  # Simulate each of the spatial random effects parameters using metropolis-hasting
  # the proposal
  sigma2_phi_proposal &amp;lt;- rmvnorm(n=1, mean=log(c(sigma2, phi)), sigma = prop_Sigma)
  # the acceptance probability
  alpha &amp;lt;- exp(dmvnorm(x = as.numeric(S), mean = rep(0, n_reg), sigma=exp(sigma2_phi_proposal[1])*exp(-U/exp(sigma2_phi_proposal[2])), log = TRUE) + 
                 dnorm(x = exp(sigma2_phi_proposal[1]), mean = 1, sd = 1.00005, log = TRUE) +  #prior of sigma2
                 dnorm(x= exp(sigma2_phi_proposal[2]), mean = 0.5, sd = 1.00001, log = TRUE)  -  #prior of phi
                 dmvnorm(x = as.numeric(S), mean = rep(0, n_reg), sigma= Sigma_s, log = TRUE)- 
                 dnorm(x = sigma2, mean = 1, sd = 1.00005, log = TRUE) -
                 dnorm(x= phi, mean = 0.5, sd = 1.00001, log = TRUE)  +
                 log(exp(sigma2_phi_proposal[1])/sigma2) + 
                 log(exp(sigma2_phi_proposal[2])/phi))
  
  if (alpha &amp;gt; runif(1)) {
    accept1 &amp;lt;- accept1 + 1
    sigma2 &amp;lt;- exp(sigma2_phi_proposal[1])
    phi &amp;lt;- exp(sigma2_phi_proposal[2])
    #cat(&amp;quot;accept =&amp;quot;, c(sigma2,phi), &amp;quot;\n&amp;quot;)
  }
  
  # Simulate each of the random effects parameters using metropolis-hasting
  # the likelihood
  # tau2.lik &amp;lt;- sum(dnorm(x = u, mean = rep(0, n_pat), sd= sqrt(tau2), log = TRUE))
  # the proposal
  tau2_proposal &amp;lt;- rnorm(n=1, mean=log(c(tau2)), sd = sqrt(prop_Sigma_tau2))
  # the acceptance probability
  alpha &amp;lt;- exp(sum(dnorm(x = u, mean = rep(0, n_pat), sd= sqrt(exp(tau2_proposal)), log = TRUE)) +  
                 dnorm(x= exp(tau2_proposal), mean = 0.2, sd = 1.0001, log = TRUE) -
                     sum(dnorm(x = u, mean = rep(0, n_pat), sd= sqrt(tau2), log = TRUE)) - 
                 dnorm(x= tau2, mean = 0.2, sd = 1.0001, log = TRUE) +
                 log(exp(tau2_proposal)/tau2)) 
  
  if (alpha &amp;gt; runif(1)) {
    accept2 &amp;lt;- accept2 + 1
    tau2 &amp;lt;- exp(tau2_proposal)
    #cat(&amp;quot;accept =&amp;quot;, tau2, &amp;quot;\n&amp;quot;)
  }
  
  #######
  # Compute posterior of S
  Sigma_s &amp;lt;-sigma2*exp(-U/phi)
  # Compute mean and variance of S
  V_s &amp;lt;- solve(diag(table(reg)) + solve(Sigma_s))
  mu_s &amp;lt;- V_s%*%(crossprod(inc_mat_reg, (z-(X%*%beta + inc_mat_pat%*%u)))) 
  S &amp;lt;- t(rmvnorm(n = 1, mean = mu_s, sigma = as.matrix(V_s)))
  
  # Compute posterior of u
  # Compute mean and variance of u
  V_u &amp;lt;- solve(diag(table(pat)) + diag(1/tau2, n_pat))
  mu_u &amp;lt;- V_u%*%(crossprod(inc_mat_pat, (z-(X%*%beta + inc_mat_reg%*%S)))) 
  u &amp;lt;- t(rmvnorm(n = 1, mean = mu_u, sigma = as.matrix(V_u)))
  
  # Compute posterior mean of beta
  M &amp;lt;- V %*% (prec_beta %*% mu_beta + crossprod(X, (z-(inc_mat_reg%*%as.numeric(S) + inc_mat_pat%*%u))))
  # M &amp;lt;- V %*% (prec_beta %*% mu_beta + crossprod(X, (z)))
  # Draw variable \theta from its full conditional: \beta | z, X
  beta &amp;lt;- c(rmvnorm(1, M, as.matrix(V)))
  
  # Update Mean of z
  mu_z &amp;lt;- X %*% beta + inc_mat_reg%*%as.numeric(S) + inc_mat_pat%*%u
  # Draw latent variable z from its full conditional: z | \theta, y, X
  z[y == 0] &amp;lt;- rtruncnorm(N0, mean = mu_z[y == 0], sd = 1, a = -Inf, b = 0)
  z[y == 1] &amp;lt;- rtruncnorm(N1, mean = mu_z[y == 1], sd = 1, a = 0, b = Inf)
  
  # Store the \theta draws
  beta_chain[t, ] &amp;lt;- beta
  # Store the z draws
  z_chain[t, ] &amp;lt;- z
  
  # Store the covariance parameters draws
  re_para[1] &amp;lt;- sigma2
  re_para[2] &amp;lt;- phi
  re_para[3] &amp;lt;- tau2
  re_para_chain[t, ] &amp;lt;- re_para
  #cat(&amp;quot;iter =&amp;quot;, t, &amp;quot;\n&amp;quot;)
}

post_beta &amp;lt;- colMeans(beta_chain[-(1:burn_in), ])
post_beta&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] -0.5684900  0.3836226&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;post_rf &amp;lt;- colMeans(re_para_chain[-(1:burn_in), ])
post_rf&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1.4133263 1.0859733 0.3904089&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;ploting-the-diagnostic-of-the-inference&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Ploting the diagnostic of the inference&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#load the package
require(ggmcmc, quietly = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;dplyr&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &amp;#39;package:stats&amp;#39;:
## 
##     filter, lag&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &amp;#39;package:base&amp;#39;:
## 
##     intersect, setdiff, setequal, union&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;tidyr&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:Matrix&amp;#39;:
## 
##     expand&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;require(coda, quietly = TRUE)
df &amp;lt;- data.frame(beta_chain, re_para_chain)
colnames(df) &amp;lt;- c(&amp;quot;beta0&amp;quot;, &amp;quot;beta1&amp;quot;, &amp;quot;sigma2&amp;quot;, &amp;quot;phi&amp;quot;, &amp;quot;tau2&amp;quot;)
df &amp;lt;- df[-1,]
df &amp;lt;- df[-(1:(burn_in-1)),]   #burn in
df &amp;lt;- df[seq(1, nrow(df), 100),]  #thining
bbb &amp;lt;- ggs(mcmc(df))   
# ggmcmc(bbb)
ggs_traceplot(bbb)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/probit_model/probit_modelling_markdown_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggs_density(bbb)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/probit_model/probit_modelling_markdown_files/figure-html/unnamed-chunk-4-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggs_autocorrelation(bbb)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/probit_model/probit_modelling_markdown_files/figure-html/unnamed-chunk-4-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# compute the acceptance rate
accept1/N_sim # for sigma2 and phi&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.09990909&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;accept2/N_sim # for tau2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.07552727&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level1 unnumbered&#34;&gt;
&lt;h1&gt;References&lt;/h1&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-albert1993bayesian&#34;&gt;
&lt;p&gt;Albert, James H, and Siddhartha Chib. 1993. “Bayesian Analysis of Binary and Polychotomous Response Data.” &lt;em&gt;Journal of the American Statistical Association&lt;/em&gt; 88 (422). Taylor &amp;amp; Francis Group: 669–79.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Besag1991&#34;&gt;
&lt;p&gt;Besag, Julian, Jeremy York, and Annie Mollié. 1991. “Bayesian image restoration, with two applications in spatial statistics.” &lt;em&gt;Annals of the Institute of Statistical Mathematics&lt;/em&gt; 43 (1): 1–20. &lt;a href=&#34;https://econpapers.repec.org/RePEc:spr:aistmt✌43:y:1991:i:1:p:1-20&#34; class=&#34;uri&#34;&gt;https://econpapers.repec.org/RePEc:spr:aistmt✌43:y:1991:i:1:p:1-20&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-brooks2011handbook&#34;&gt;
&lt;p&gt;Brooks, Steve, Andrew Gelman, Galin Jones, and Xiao-Li Meng. 2011. &lt;em&gt;Handbook of Markov Chain Monte Carlo&lt;/em&gt;. CRC press.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-lesage2000bayesian&#34;&gt;
&lt;p&gt;LeSage, James P. 2000. “Bayesian Estimation of Limited Dependent Variable Spatial Autoregressive Models.” &lt;em&gt;Geographical Analysis&lt;/em&gt; 32 (1). Wiley Online Library: 19–35.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-lesage2009introduction&#34;&gt;
&lt;p&gt;LeSage, James, and Robert Kelley Pace. 2009. &lt;em&gt;Introduction to Spatial Econometrics&lt;/em&gt;. Chapman; Hall/CRC.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-smith2004bayesian&#34;&gt;
&lt;p&gt;Smith, Tony E, and James P LeSage. 2004. “A Bayesian Probit Model with Spatial Dependencies.” In &lt;em&gt;Spatial and Spatiotemporal Econometrics&lt;/em&gt;, 127–60. Emerald Group Publishing Limited.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Fitting Geostatistical Model Using TensorFlow API from R</title>
      <link>/post/geostatisticswithtensorflow/geostatistics_mle_tf/</link>
      <pubDate>Sat, 02 Mar 2019 00:00:00 +0000</pubDate>
      <guid>/post/geostatisticswithtensorflow/geostatistics_mle_tf/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;This tutorial simply estimate the parameter of a geostatistical model using the TensorFlow API from R. There are many tutorial and links online on how to use TensorFlow in R, see &lt;a href=&#34;https://www.r-bloggers.com/an-introduction-to-tensorflow/&#34; class=&#34;uri&#34;&gt;https://www.r-bloggers.com/an-introduction-to-tensorflow/&lt;/a&gt; for an introduction to TensorFlow and &lt;a href=&#34;https://kyleclo.github.io/maximum-likelihood-in-tensorflow-pt-1/&#34; class=&#34;uri&#34;&gt;https://kyleclo.github.io/maximum-likelihood-in-tensorflow-pt-1/&lt;/a&gt; for TensorFlow’s autodifferentiation toolbox for maximum likelihood estimation.&lt;/p&gt;
&lt;p&gt;TensorFlow is popularly used machine learning and deep learning. It is very essential that statisticians begin to benefit from its features. Some of the features that can be useful are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;autodifferentiation.&lt;/li&gt;
&lt;li&gt;It automatically suports Multicore CPU and GPU.&lt;/li&gt;
&lt;li&gt;It can be used from R. I will show this very soon.&lt;/li&gt;
&lt;li&gt;Graphical probabilistic modelling is very possible with the use of TensorFlow Probability.&lt;/li&gt;
&lt;li&gt;One can monitor the learning process through the TensorBoard.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The section that follows gives a general description typical geostatistical model.&lt;/p&gt;
&lt;div id=&#34;linear-geostatistical-model&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Linear geostatistical model&lt;/h2&gt;
&lt;p&gt;Let &lt;span class=&#34;math inline&#34;&gt;\(y_i\)&lt;/span&gt; for &lt;span class=&#34;math inline&#34;&gt;\(i = 1, \ldots, n\)&lt;/span&gt; denote measurements at locations &lt;span class=&#34;math inline&#34;&gt;\(x_i \in A \subset \mathcal{R}^2\)&lt;/span&gt; , where &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; corresponds to the area of interest. Let &lt;span class=&#34;math inline&#34;&gt;\(S(x)\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(Z(x)\)&lt;/span&gt; denote a stationary zero-mean Gaussian process and Gaussian noise, respectively. The standard linear geostatsitical model for the data can then be expressed as &lt;span class=&#34;math display&#34;&gt;\[Y(x_i) = d(x_i)^\top  \beta + S(x_i) + Z(x_i)\]&lt;/span&gt; where &lt;span class=&#34;math inline&#34;&gt;\(Y(x_i)\)&lt;/span&gt; is the random variable associated with the data &lt;span class=&#34;math inline&#34;&gt;\(y(x_i)\)&lt;/span&gt; , and &lt;span class=&#34;math inline&#34;&gt;\(d(x_i)\)&lt;/span&gt; is a vector of the covariates with corresponding vector of regression coefficients &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;. We also assume that the stationary process &lt;span class=&#34;math inline&#34;&gt;\(S(x)\)&lt;/span&gt; is isotropic, &lt;span class=&#34;math inline&#34;&gt;\(cov{S(x), S(x 0 )} = \sigma^2 \rho(u; \phi),\)&lt;/span&gt; where &lt;span class=&#34;math inline&#34;&gt;\(\sigma^2\)&lt;/span&gt; is the variance of &lt;span class=&#34;math inline&#34;&gt;\(S(x)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\rho(\cdot; \phi)\)&lt;/span&gt; is a correlation function with parameter &lt;span class=&#34;math inline&#34;&gt;\(\phi\)&lt;/span&gt; (assumed to be exponential in this case) and &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; is the Euclidean distance between &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(x&amp;#39;\)&lt;/span&gt; . Finally, we use &lt;span class=&#34;math inline&#34;&gt;\(\tau^2\)&lt;/span&gt; to denote the variance of the Gaussian noise &lt;span class=&#34;math inline&#34;&gt;\(Z(x_i)\)&lt;/span&gt;. &lt;span class=&#34;math inline&#34;&gt;\(\theta = (\beta, \sigma^2, \phi, \tau^2)\)&lt;/span&gt; is the vector of the parameter in the model.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;geostatistics-with-tensorflow&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Geostatistics with TensorFlow&lt;/h1&gt;
&lt;p&gt;Simulating the data&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;n &amp;lt;- 625  # number of data point
x &amp;lt;- rnorm(n)  # simulating a covariate
### generate the data location
xy &amp;lt;- expand.grid(x=seq(0, 3, length.out = sqrt(n)), y=seq(0, 3, length.out = sqrt(n)))
d &amp;lt;- as.matrix(dist(xy))  # compute the distance matrix

# The parameters of the model
beta0 &amp;lt;- 0.5
beta1 &amp;lt;- 2.5
sigma2 &amp;lt;- 1
phi &amp;lt;- 0.3
tau2 &amp;lt;- 0.1

# Generate the covariance matrix of the process
Sigma &amp;lt;- sigma2*exp(-d/phi)
S &amp;lt;- t(chol(Sigma))%*%rnorm(n)

# Finally simulate the data
y &amp;lt;- as.numeric(beta0 + beta1 *x  + S + rnorm(n = n, mean = 0, sd = sqrt(tau2)))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Loading the R packages&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#Load the package
library(tensorflow)
tfp &amp;lt;- import(&amp;quot;tensorflow_probability&amp;quot;) # import the tensorflow probability
tfd &amp;lt;- tfp$distributions   # get the tensorflow distributions&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Defining the model&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sess &amp;lt;- tf$Session()

x_data &amp;lt;- tf$placeholder(dtype = &amp;quot;float&amp;quot;,
                         shape = n,
                         name = &amp;quot;x&amp;quot;) # Placeholder for Petal.Length
y_data &amp;lt;- tf$placeholder(dtype = &amp;quot;float&amp;quot;,
                         shape = n,
                         name = &amp;quot;y&amp;quot;)  # Placeholder for Petal.Width

d_mat &amp;lt;- tf$placeholder(dtype = tf$float32,  name=&amp;quot;d&amp;quot;)

beta0 &amp;lt;- tf$Variable(0.1,   name = &amp;quot;Intercept&amp;quot;)
beta1 &amp;lt;- tf$Variable(0.1,   name = &amp;quot;coefficient&amp;quot;)

#initialise the parameters
sigma2 &amp;lt;- tf$Variable(0.1, name = &amp;quot;sigma2&amp;quot;)
phi &amp;lt;- tf$Variable(0.1, name = &amp;quot;phi&amp;quot;)
tau2 &amp;lt;- tf$Variable(0.1, name = &amp;quot;tau2&amp;quot;)

# The expectation of the model
y_hat &amp;lt;- beta0 + beta1 * x_data &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Maximum Likelihood Estimation&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Setting up the model
n &amp;lt;- tf$constant(n)
# define a Gaussian distribution with mean = y_hat and covariance matrix using an exponential covariance function
gaussian_dist &amp;lt;- tfd$MultivariateNormalFullCovariance(loc = y_hat, covariance_matrix = sigma2*tf$exp(-d_mat/phi) + tf$eye(n)*tau2)
# log_likelihood (y_data | theta)
log_prob &amp;lt;- gaussian_dist$log_prob(value = y_data)
# negative_log_likelihood (y_data | theta)
neg_log_likelihood &amp;lt;- -1.0 * tf$reduce_sum(log_prob)

# gradient of neg_log_likelihood wrt (theta)
grad &amp;lt;- tf$gradients(neg_log_likelihood,c(beta0, beta1, sigma2, phi, tau2))

# optimizer
optimizer &amp;lt;- tf$train$AdamOptimizer(learning_rate = 0.01)
train_op &amp;lt;- optimizer$minimize(loss = neg_log_likelihood)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creating an interface of the tensorboard&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;MSE_hist &amp;lt;- tf$summary$scalar(&amp;quot;neg_log_likelihood&amp;quot;, neg_log_likelihood)   # save all values of neg_log_likelihood
beta0_hist &amp;lt;- tf$summary$scalar(&amp;quot;Intercept&amp;quot;, beta0)
beta1_hist &amp;lt;- tf$summary$scalar(&amp;quot;Coefficient&amp;quot;, beta1)
sigma2_hist &amp;lt;- tf$summary$scalar(&amp;quot;sigma2&amp;quot;, sigma2)
phi_hist &amp;lt;- tf$summary$scalar(&amp;quot;phi&amp;quot;, phi)
tau2_hist &amp;lt;- tf$summary$scalar(&amp;quot;tau2&amp;quot;, tau2)
merged &amp;lt;- tf$summary$merge_all()            # Merges all summaries collected in the default graph.
train_writer &amp;lt;- tf$summary$FileWriter(logdir = &amp;quot;logs&amp;quot;)
train_writer$add_graph(sess$graph)          # add a graph structure&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Running the session&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sess$run(tf$global_variables_initializer())
for (epoch in 1:200) {
  result &amp;lt;- sess$run(list(merged,              # the merged parameters and 
                          train_op,            # Min neg_log_likelihood
                          neg_log_likelihood,  # neg_log_likelihood
                          grad),               # Gradient
                     feed_dict = dict(x_data = x,
                                      y_data =  y, d_mat=d))
  summary &amp;lt;- result[[1]]                    # extract the summary result of merged
  train_writer$add_summary(summary, epoch)  # write summary to disk
}
#print the maximum likelihood estimate of the parameters
cat(&amp;quot;Intercept: &amp;quot;, sess$run(beta0), &amp;quot;\n Coefficient: &amp;quot;, sess$run(beta1), &amp;quot;\n sigma2: &amp;quot;, 
    sess$run(sigma2), &amp;quot;\n phi: &amp;quot;, sess$run(phi), &amp;quot;\n tau2: &amp;quot;, sess$run(tau2), &amp;quot;\n&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Intercept:  0.2836692 
##  Coefficient:  1.201712 
##  sigma2:  0.5700233 
##  phi:  0.110626 
##  tau2:  0.5315924&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# print the gradient of the log-likelihood with respect to the parameters 
cat(&amp;quot;Gradient wrt: d.beta0 &amp;quot;, result[[4]][[1]], &amp;quot;\n d.beta1: &amp;quot;, result[[4]][[2]], &amp;quot;\n d.sigma2: &amp;quot;, result[[4]][[3]], 
    &amp;quot;\n d.phi: &amp;quot;, result[[4]][[4]], &amp;quot;\n d.tau2: &amp;quot;, result[[4]][[5]], &amp;quot; \n&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Gradient wrt: d.beta0  -3.351908 
##  d.beta1:  -768.9117 
##  d.sigma2:  -328.6408 
##  d.phi:  190.2612 
##  d.tau2:  -392.9058&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sess$close()
tf$reset_default_graph()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Monitoring with TensorBoard&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tensorboard(log_dir = &amp;quot;logs&amp;quot;) # Play with tensorboard&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Started TensorBoard at http://127.0.0.1:3902&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Slides</title>
      <link>/slides/example/</link>
      <pubDate>Tue, 05 Feb 2019 00:00:00 +0000</pubDate>
      <guid>/slides/example/</guid>
      <description>&lt;h1 id=&#34;create-slides-in-markdown-with-academic&#34;&gt;Create slides in Markdown with Academic&lt;/h1&gt;
&lt;p&gt;
&lt;a href=&#34;https://sourcethemes.com/academic/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Academic&lt;/a&gt; | 
&lt;a href=&#34;https://sourcethemes.com/academic/docs/managing-content/#create-slides&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Documentation&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;features&#34;&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Efficiently write slides in Markdown&lt;/li&gt;
&lt;li&gt;3-in-1: Create, Present, and Publish your slides&lt;/li&gt;
&lt;li&gt;Supports speaker notes&lt;/li&gt;
&lt;li&gt;Mobile friendly slides&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;controls&#34;&gt;Controls&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Next: &lt;code&gt;Right Arrow&lt;/code&gt; or &lt;code&gt;Space&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Previous: &lt;code&gt;Left Arrow&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start: &lt;code&gt;Home&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Finish: &lt;code&gt;End&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Overview: &lt;code&gt;Esc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Speaker notes: &lt;code&gt;S&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Fullscreen: &lt;code&gt;F&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Zoom: &lt;code&gt;Alt + Click&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;
&lt;a href=&#34;https://github.com/hakimel/reveal.js#pdf-export&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PDF Export&lt;/a&gt;: &lt;code&gt;E&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;code-highlighting&#34;&gt;Code Highlighting&lt;/h2&gt;
&lt;p&gt;Inline code: &lt;code&gt;variable&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Code block:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;porridge = &amp;quot;blueberry&amp;quot;
if porridge == &amp;quot;blueberry&amp;quot;:
    print(&amp;quot;Eating...&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id=&#34;math&#34;&gt;Math&lt;/h2&gt;
&lt;p&gt;In-line math: $x + y = z$&lt;/p&gt;
&lt;p&gt;Block math:&lt;/p&gt;
&lt;p&gt;$$
f\left( x \right) = ;\frac{{2\left( {x + 4} \right)\left( {x - 4} \right)}}{{\left( {x + 4} \right)\left( {x + 1} \right)}}
$$&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;fragments&#34;&gt;Fragments&lt;/h2&gt;
&lt;p&gt;Make content appear incrementally&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{% fragment %}} One {{% /fragment %}}
{{% fragment %}} **Two** {{% /fragment %}}
{{% fragment %}} Three {{% /fragment %}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Press &lt;code&gt;Space&lt;/code&gt; to play!&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;fragment &#34; &gt;
One
&lt;/span&gt;
&lt;span class=&#34;fragment &#34; &gt;
&lt;strong&gt;Two&lt;/strong&gt;
&lt;/span&gt;
&lt;span class=&#34;fragment &#34; &gt;
Three
&lt;/span&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;A fragment can accept two optional parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;class&lt;/code&gt;: use a custom style (requires definition in custom CSS)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;weight&lt;/code&gt;: sets the order in which a fragment appears&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;speaker-notes&#34;&gt;Speaker Notes&lt;/h2&gt;
&lt;p&gt;Add speaker notes to your presentation&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-markdown&#34;&gt;{{% speaker_note %}}
- Only the speaker can read these notes
- Press `S` key to view
{{% /speaker_note %}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Press the &lt;code&gt;S&lt;/code&gt; key to view the speaker notes!&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;ul&gt;
&lt;li&gt;Only the speaker can read these notes&lt;/li&gt;
&lt;li&gt;Press &lt;code&gt;S&lt;/code&gt; key to view&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;themes&#34;&gt;Themes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;black: Black background, white text, blue links (default)&lt;/li&gt;
&lt;li&gt;white: White background, black text, blue links&lt;/li&gt;
&lt;li&gt;league: Gray background, white text, blue links&lt;/li&gt;
&lt;li&gt;beige: Beige background, dark text, brown links&lt;/li&gt;
&lt;li&gt;sky: Blue background, thin dark text, blue links&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;night: Black background, thick white text, orange links&lt;/li&gt;
&lt;li&gt;serif: Cappuccino background, gray text, brown links&lt;/li&gt;
&lt;li&gt;simple: White background, black text, blue links&lt;/li&gt;
&lt;li&gt;solarized: Cream-colored background, dark green text, blue links&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;/img/boards.jpg&#34;
  &gt;

&lt;h2 id=&#34;custom-slide&#34;&gt;Custom Slide&lt;/h2&gt;
&lt;p&gt;Customize the slide style and background&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-markdown&#34;&gt;{{&amp;lt; slide background-image=&amp;quot;/img/boards.jpg&amp;quot; &amp;gt;}}
{{&amp;lt; slide background-color=&amp;quot;#0000FF&amp;quot; &amp;gt;}}
{{&amp;lt; slide class=&amp;quot;my-style&amp;quot; &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id=&#34;custom-css-example&#34;&gt;Custom CSS Example&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s make headers navy colored.&lt;/p&gt;
&lt;p&gt;Create &lt;code&gt;assets/css/reveal_custom.css&lt;/code&gt; with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-css&#34;&gt;.reveal section h1,
.reveal section h2,
.reveal section h3 {
  color: navy;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h1 id=&#34;questions&#34;&gt;Questions?&lt;/h1&gt;
&lt;p&gt;
&lt;a href=&#34;https://spectrum.chat/academic&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ask&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://sourcethemes.com/academic/docs/managing-content/#create-slides&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Documentation&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>A Spatially Discrete Approximation to Log-Gaussian Cox Processes for Modelling Aggregated Disease Count Data</title>
      <link>/talk/toronto/</link>
      <pubDate>Fri, 15 Jun 2018 13:00:00 +0000</pubDate>
      <guid>/talk/toronto/</guid>
      <description></description>
    </item>
    
    <item>
      <title>External Project</title>
      <link>/project/external-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0000</pubDate>
      <guid>/project/external-project/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Internal Project</title>
      <link>/project/internal-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0000</pubDate>
      <guid>/project/internal-project/</guid>
      <description>&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;
&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;
&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;
&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;
&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>An improved Warner’s randomized response model</title>
      <link>/publication/warner2/</link>
      <pubDate>Tue, 01 Sep 2015 00:00:00 +0100</pubDate>
      <guid>/publication/warner2/</guid>
      <description></description>
    </item>
    
    <item>
      <title>A modified stratified randomized response technique</title>
      <link>/publication/warner1/</link>
      <pubDate>Mon, 01 Sep 2014 00:00:00 +0100</pubDate>
      <guid>/publication/warner1/</guid>
      <description></description>
    </item>
    
  </channel>
</rss>
